<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Market Analysis I - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://curest0x1021.github.io/Leetcode-Solution/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://curest0x1021.github.io/Leetcode-Solution/static/css/app.css"/></head><body><header><h1>1158. Market Analysis I</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://curest0x1021.github.io/Leetcode-Solution/difficulty/medium" class="tag">Medium</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/database">Database</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>Table: <code>Users</code></p>
<pre><code class="hljs">+----------------+---------+
| Column Name    |<span class="hljs-built_in"> Type </span>   |
+----------------+---------+
| user_id        | int     |
| join_date      | date    |
| favorite_brand | varchar |
+----------------+---------+
user_id is the primary key of this table.
This table has the <span class="hljs-builtin-name">info</span> of the<span class="hljs-built_in"> users </span>of an online shopping website where<span class="hljs-built_in"> users </span>can sell <span class="hljs-keyword">and</span> buy items.
</code></pre>
<p>&nbsp;</p>
<p>Table: <code>Orders</code></p>
<pre><code class="hljs">+---------------+---------+
| Column Name   |<span class="hljs-built_in"> Type </span>   |
+---------------+---------+
| order_id      | int     |
| order_date    | date    |
| item_id       | int     |
| buyer_id      | int     |
| seller_id     | int     |
+---------------+---------+
order_id is the primary key of this table.
item_id is a foreign key <span class="hljs-keyword">to</span> the Items table.
buyer_id <span class="hljs-keyword">and</span> seller_id are foreign keys <span class="hljs-keyword">to</span> the<span class="hljs-built_in"> Users </span>table.
</code></pre>
<p>&nbsp;</p>
<p>Table: <code>Items</code></p>
<pre><code class="hljs">+<span class="hljs-comment">---------------+---------+</span>
| <span class="hljs-keyword">Column</span> <span class="hljs-type">Name</span>   | <span class="hljs-keyword">Type</span>    |
+<span class="hljs-comment">---------------+---------+</span>
| item_id       | <span class="hljs-type">int</span>     |
| item_brand    | <span class="hljs-type">varchar</span> |
+<span class="hljs-comment">---------------+---------+</span>
item_id <span class="hljs-keyword">is</span> the <span class="hljs-keyword">primary key</span> <span class="hljs-keyword">of</span> this <span class="hljs-keyword">table</span>.
</code></pre>
<p>&nbsp;</p>
<p>Write an SQL query to find for each user, the join date and the number of orders they made as a buyer in <code>2019</code>.</p>
<p>Return the result table in <strong>any order</strong>.</p>
<p>The query result format is in the following example.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs">Input: 
<span class="hljs-section">Users table:
+---------+------------+----------------+</span>
<span class="hljs-section">| user_id | join_date  | favorite_brand |
+---------+------------+----------------+</span>
| 1       | 2018-01-01 | Lenovo         |
| 2       | 2018-02-09 | Samsung        |
| 3       | 2018-01-19 | LG             |
<span class="hljs-section">| 4       | 2018-05-21 | HP             |
+---------+------------+----------------+</span>
<span class="hljs-section">Orders table:
+----------+------------+---------+----------+-----------+</span>
<span class="hljs-section">| order_id | order_date | item_id | buyer_id | seller_id |
+----------+------------+---------+----------+-----------+</span>
| 1        | 2019-08-01 | 4       | 1        | 2         |
| 2        | 2018-08-02 | 2       | 1        | 3         |
| 3        | 2019-08-03 | 3       | 2        | 3         |
| 4        | 2018-08-04 | 1       | 4        | 2         |
| 5        | 2018-08-04 | 1       | 3        | 4         |
<span class="hljs-section">| 6        | 2019-08-05 | 2       | 2        | 4         |
+----------+------------+---------+----------+-----------+</span>
<span class="hljs-section">Items table:
+---------+------------+</span>
<span class="hljs-section">| item_id | item_brand |
+---------+------------+</span>
| 1       | Samsung    |
| 2       | Lenovo     |
| 3       | LG         |
<span class="hljs-section">| 4       | HP         |
+---------+------------+</span>
<span class="hljs-section">Output: 
+-----------+------------+----------------+</span>
<span class="hljs-section">| buyer_id  | join_date  | orders_in_2019 |
+-----------+------------+----------------+</span>
| 1         | 2018-01-01 | 1              |
| 2         | 2018-02-09 | 2              |
| 3         | 2018-01-19 | 0              |
<span class="hljs-section">| 4         | 2018-05-21 | 0              |
+-----------+------------+----------------+</span>
</code></pre>
<h2 id="solution">Solution</h2>
<pre><code class="hljs lang-sql"><span class="hljs-comment"># Write your MySQL query statement below</span>
<span class="hljs-keyword">SELECT</span> U.user_id <span class="hljs-keyword">AS</span> buyer_id, U.join_date, <span class="hljs-keyword">IFNULL</span>(USERS_ORDERED_IN_2019.orders_in_2019, <span class="hljs-number">0</span>) <span class="hljs-keyword">AS</span> orders_in_2019 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Users</span> U
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">SELECT</span> U.user_id <span class="hljs-keyword">AS</span> user_id, <span class="hljs-keyword">COUNT</span>(O.item_id) <span class="hljs-keyword">AS</span> orders_in_2019 <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Users</span> U
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Orders O <span class="hljs-keyword">ON</span> O.buyer_id = U.user_id
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">YEAR</span>(O.order_date) = <span class="hljs-number">2019</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> U.user_id) <span class="hljs-keyword">AS</span> USERS_ORDERED_IN_2019
<span class="hljs-keyword">ON</span> U.user_id = USERS_ORDERED_IN_2019.user_id;
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/curest0x1021/Leetcode-Solution" target="_blank"><img src="https://curest0x1021.github.io/Leetcode-Solution/static/img/github.png" alt="github"/></a></footer></body></html>