<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Count Different Palindromic Subsequences - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://baffinlee.com/leetcode-javascript/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://baffinlee.com/leetcode-javascript/static/css/app.css"/></head><body><header><h1>730. Count Different Palindromic Subsequences</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://baffinlee.com/leetcode-javascript/difficulty/hard" class="tag">Hard</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://baffinlee.com/leetcode-javascript/tag/string">String</a></li><li><a href="https://baffinlee.com/leetcode-javascript/tag/dynamic-programming">Dynamic Programming</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"><li><a href="https://baffinlee.com/leetcode-javascript/problem/longest-palindromic-subsequence.html">Longest Palindromic Subsequence</a></li></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>Given a string s, return <strong>the number of different non-empty palindromic subsequences in</strong> <code>s</code>. Since the answer may be very large, return it <strong>modulo</strong> <code>109 + 7</code>.</p>
<p>A subsequence of a string is obtained by deleting zero or more characters from the string.</p>
<p>A sequence is palindromic if it is equal to the sequence reversed.</p>
<p>Two sequences <code>a1, a2, ...</code> and <code>b1, b2, ...</code> are different if there is some <code>i</code> for which <code>ai != bi</code>.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs">Input: s = <span class="hljs-string">"bccb"</span>
Output: 6
Explanation: The 6 different non-empty palindromic subsequences are <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'bb'</span>, <span class="hljs-string">'cc'</span>, <span class="hljs-string">'bcb'</span>, <span class="hljs-string">'bccb'</span>.<span class="hljs-built_in">
Note </span>that <span class="hljs-string">'bcb'</span> is counted only once, even though it occurs twice.
</code></pre>
<p><strong>Example 2:</strong></p>
<pre><code class="hljs"><span class="hljs-attr">Input:</span> <span class="hljs-string">s</span> <span class="hljs-string">=</span> <span class="hljs-string">"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcba"</span>
<span class="hljs-attr">Output:</span> <span class="hljs-number">104860361</span>
<span class="hljs-attr">Explanation:</span> <span class="hljs-string">There</span> <span class="hljs-string">are</span> <span class="hljs-number">3104860382</span> <span class="hljs-string">different</span> <span class="hljs-string">non-empty</span> <span class="hljs-string">palindromic</span> <span class="hljs-string">subsequences,</span> <span class="hljs-string">which</span> <span class="hljs-string">is</span> <span class="hljs-number">104860361</span> <span class="hljs-string">modulo</span> <span class="hljs-number">109</span> <span class="hljs-string">+</span> <span class="hljs-number">7</span><span class="hljs-string">.</span>
</code></pre>
<p>&nbsp;
<strong>Constraints:</strong></p>
<ul>
<li><p><code>1 &lt;= s.length &lt;= 1000</code></p></li>
<li><p><code>s[i]</code> is either <code>'a'</code>, <code>'b'</code>, <code>'c'</code>, or <code>'d'</code>.</p></li>
</ul>
<h2 id="solution-java">Solution (Java)</h2>
<pre><code class="hljs lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countPalindromicSubsequences</span><span class="hljs-params">(String s)</span> </span>{
        <span class="hljs-keyword">int</span> big = <span class="hljs-number">1000000007</span>;
        <span class="hljs-keyword">int</span> len = s.length();
        <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">return</span> len;
        }
        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][len];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
            <span class="hljs-keyword">char</span> c = s.charAt(i);
            <span class="hljs-keyword">int</span> deta = <span class="hljs-number">1</span>;
            dp[i][i] = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">int</span> l2 = -<span class="hljs-number">1</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) {
                <span class="hljs-keyword">if</span> (s.charAt(j) == c) {
                    <span class="hljs-keyword">if</span> (l2 &lt; <span class="hljs-number">0</span>) {
                        l2 = j;
                        deta = dp[j + <span class="hljs-number">1</span>][i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;
                    } <span class="hljs-keyword">else</span> {
                        deta = dp[j + <span class="hljs-number">1</span>][i - <span class="hljs-number">1</span>] - dp[j + <span class="hljs-number">1</span>][l2 - <span class="hljs-number">1</span>];
                    }
                    deta = deal(deta, big);
                }
                dp[j][i] = deal(dp[j][i - <span class="hljs-number">1</span>] + deta, big);
            }
        }
        <span class="hljs-keyword">return</span> deal(dp[<span class="hljs-number">0</span>][len - <span class="hljs-number">1</span>], big);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> big)</span> </span>{
        x %= big;
        <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">0</span>) {
            x += big;
        }
        <span class="hljs-keyword">return</span> x;
    }
}
</code></pre>
<h2 id="solution-c">Solution (C++)</h2>
<pre><code class="hljs lang-cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">countPalindromicSubsequences</span><span class="hljs-params">(<span class="hljs-built_in">string</span> S)</span> </span>{
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> P = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> chars = <span class="hljs-string">"abcd"</span>;
        <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;&gt; <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-number">3</span>, <span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;(S.size(), <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;(<span class="hljs-number">4</span>)))</span></span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> len = <span class="hljs-number">1</span>; len &lt;= S.size(); ++len) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i + len &lt;= S.size(); ++i) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span>&amp; c : chars) {
                    dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] = <span class="hljs-number">0</span>;
                    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">1</span>) {
                        dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] = S[i] == c;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">if</span> (S[i] != c) {
                            dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] = dp[(len - <span class="hljs-number">1</span>) % <span class="hljs-number">3</span>][i + <span class="hljs-number">1</span>][c - <span class="hljs-string">'a'</span>];
                        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (S[i + len - <span class="hljs-number">1</span>] != c) {
                            dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] = dp[(len - <span class="hljs-number">1</span>) % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>];
                        } <span class="hljs-keyword">else</span> {
                            dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] = <span class="hljs-number">2</span>;
                            <span class="hljs-keyword">if</span> (len &gt; <span class="hljs-number">2</span>) {
                                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span>&amp; cc : chars) {
                                    dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] += dp[(len - <span class="hljs-number">2</span>) % <span class="hljs-number">3</span>][i + <span class="hljs-number">1</span>][cc - <span class="hljs-string">'a'</span>];
                                    dp[len % <span class="hljs-number">3</span>][i][c - <span class="hljs-string">'a'</span>] %= P;
                                }
                            }
                        }
                    }
                }
            }
        }
        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span>&amp; c : chars) {
            result = (result + dp[S.size() % <span class="hljs-number">3</span>][<span class="hljs-number">0</span>][c - <span class="hljs-string">'a'</span>]) % P;
        }
        <span class="hljs-keyword">return</span> result;
    }
};
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/BaffinLee/leetcode-javascript" target="_blank"><img src="https://baffinlee.com/leetcode-javascript/static/img/github.png" alt="github"/></a></footer></body></html>