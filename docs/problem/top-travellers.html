<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Top Travellers - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://curest0x1021.github.io/Leetcode-Solution/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://curest0x1021.github.io/Leetcode-Solution/static/css/app.css"/></head><body><header><h1>1541. Top Travellers</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://curest0x1021.github.io/Leetcode-Solution/difficulty/easy" class="tag">Easy</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/database">Database</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>Table: <code>Users</code></p>
<pre><code class="hljs"><span class="hljs-code">+---------------+</span>---------+
<span class="hljs-section">| Column Name   | Type    |
+---------------+---------+</span>
| id            | int     |
<span class="hljs-section">| name          | varchar |
+---------------+---------+</span>
id is the primary key for this table.
name is the name of the user.
</code></pre>
<p>&nbsp;</p>
<p>Table: <code>Rides</code></p>
<pre><code class="hljs">+---------------+---------+
| Column Name   |<span class="hljs-built_in"> Type </span>   |
+---------------+---------+
| id            | int     |
| user_id       | int     |
| distance      | int     |
+---------------+---------+
id is the primary key <span class="hljs-keyword">for</span> this table.
user_id is the id of the<span class="hljs-built_in"> user </span>who traveled the distance <span class="hljs-string">"distance"</span>.
</code></pre>
<p>&nbsp;</p>
<p>Write an SQL query to report the distance traveled by each user.</p>
<p>Return the result table ordered by <code>travelled_distance</code> in <strong>descending order</strong>, if two or more users traveled the same distance, order them by their <code>name</code> in <strong>ascending order</strong>.</p>
<p>The query result format is in the following example.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs">Input: 
<span class="hljs-section">Users table:
+------+-----------+</span>
<span class="hljs-section">| id   | name      |
+------+-----------+</span>
| 1    | Alice     |
| 2    | Bob       |
| 3    | Alex      |
| 4    | Donald    |
| 7    | Lee       |
| 13   | Jonathan  |
<span class="hljs-section">| 19   | Elvis     |
+------+-----------+</span>
<span class="hljs-section">Rides table:
+------+----------+----------+</span>
<span class="hljs-section">| id   | user_id  | distance |
+------+----------+----------+</span>
| 1    | 1        | 120      |
| 2    | 2        | 317      |
| 3    | 3        | 222      |
| 4    | 7        | 100      |
| 5    | 13       | 312      |
| 6    | 19       | 50       |
| 7    | 7        | 120      |
| 8    | 19       | 400      |
<span class="hljs-section">| 9    | 7        | 230      |
+------+----------+----------+</span>
<span class="hljs-section">Output: 
+----------+--------------------+</span>
<span class="hljs-section">| name     | travelled_distance |
+----------+--------------------+</span>
| Elvis    | 450                |
| Lee      | 450                |
| Bob      | 317                |
| Jonathan | 312                |
| Alex     | 222                |
| Alice    | 120                |
<span class="hljs-section">| Donald   | 0                  |
+----------+--------------------+</span>
Explanation: 
Elvis and Lee traveled 450 miles, Elvis is the top traveler as his name is alphabetically smaller than Lee.
Bob, Jonathan, Alex, and Alice have only one ride and we just order them by the total distances of the ride.
Donald did not have any rides, the distance traveled by him is 0.
</code></pre>
<h2 id="solution">Solution</h2>
<pre><code class="hljs lang-sql"><span class="hljs-comment"># Write your MySQL query statement below</span>
<span class="hljs-keyword">select</span>
    u.name,
    <span class="hljs-keyword">ifnull</span>(r.tot,<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> travelled_distance
<span class="hljs-keyword">from</span>
    <span class="hljs-keyword">Users</span> u
    <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span>
    (<span class="hljs-keyword">select</span> user_id, <span class="hljs-keyword">sum</span>(distance) <span class="hljs-keyword">as</span> tot
    <span class="hljs-keyword">from</span> Rides
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id) r
<span class="hljs-keyword">on</span> 
    u.id = r.user_id
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span>
    r.tot <span class="hljs-keyword">desc</span>,
    u.name
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/curest0x1021/Leetcode-Solution" target="_blank"><img src="https://curest0x1021.github.io/Leetcode-Solution/static/img/github.png" alt="github"/></a></footer></body></html>