<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Number of Ways to Form a Target String Given a Dictionary - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://curest0x1021.github.io/Leetcode-Solution/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://curest0x1021.github.io/Leetcode-Solution/static/css/app.css"/></head><body><header><h1>1639. Number of Ways to Form a Target String Given a Dictionary</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://curest0x1021.github.io/Leetcode-Solution/difficulty/hard" class="tag">Hard</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/array">Array</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/string">String</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/dynamic-programming">Dynamic Programming</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>You are given a list of strings of the <strong>same length</strong> <code>words</code> and a string <code>target</code>.</p>
<p>Your task is to form <code>target</code> using the given <code>words</code> under the following rules:</p>
<ul>
<li><p><code>target</code> should be formed from left to right.</p></li>
<li><p>To form the <code>ith</code> character (<strong>0-indexed</strong>) of <code>target</code>, you can choose the <code>kth</code> character of the <code>jth</code> string in <code>words</code> if <code>target[i] = words[j][k]</code>.</p></li>
<li><p>Once you use the <code>kth</code> character of the <code>jth</code> string of <code>words</code>, you <strong>can no longer</strong> use the <code>xth</code> character of any string in <code>words</code> where <code>x &lt;= k</code>. In other words, all characters to the left of or at index <code>k</code> become unusuable for every string.</p></li>
<li><p>Repeat the process until you form the string <code>target</code>.</p></li>
</ul>
<p><strong>Notice</strong> that you can use <strong>multiple characters</strong> from the <strong>same string</strong> in <code>words</code> provided the conditions above are met.</p>
<p>Return <strong>the number of ways to form <code>target</code> from <code>words</code></strong>. Since the answer may be too large, return it <strong>modulo</strong> <code>109 + 7</code>.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs">Inpu<span class="hljs-variable">t:</span> words = [<span class="hljs-string">"acca"</span>,<span class="hljs-string">"bbbb"</span>,<span class="hljs-string">"caca"</span>], target = <span class="hljs-string">"aba"</span>
Outpu<span class="hljs-variable">t:</span> <span class="hljs-number">6</span>
Explanation: There are <span class="hljs-number">6</span> ways <span class="hljs-keyword">to</span> form target.
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"acca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"caca"</span>)
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"acca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"caca"</span>)
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"acca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"acca"</span>)
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"acca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"acca"</span>)
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"caca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"acca"</span>)
<span class="hljs-string">"aba"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"caca"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"bbbb"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"caca"</span>)
</code></pre>
<p><strong>Example 2:</strong></p>
<pre><code class="hljs">Inpu<span class="hljs-variable">t:</span> words = [<span class="hljs-string">"abba"</span>,<span class="hljs-string">"baab"</span>], target = <span class="hljs-string">"bab"</span>
Outpu<span class="hljs-variable">t:</span> <span class="hljs-number">4</span>
Explanation: There are <span class="hljs-number">4</span> ways <span class="hljs-keyword">to</span> form target.
<span class="hljs-string">"bab"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"abba"</span>)
<span class="hljs-string">"bab"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"baab"</span>)
<span class="hljs-string">"bab"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">0</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"baab"</span>)
<span class="hljs-string">"bab"</span> -&gt; <span class="hljs-built_in">index</span> <span class="hljs-number">1</span> (<span class="hljs-string">"abba"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">2</span> (<span class="hljs-string">"baab"</span>), <span class="hljs-built_in">index</span> <span class="hljs-number">3</span> (<span class="hljs-string">"baab"</span>)
</code></pre>
<p>&nbsp;
<strong>Constraints:</strong></p>
<ul>
<li><p><code>1 &lt;= words.length &lt;= 1000</code></p></li>
<li><p><code>1 &lt;= words[i].length &lt;= 1000</code></p></li>
<li><p>All strings in <code>words</code> have the same length.</p></li>
<li><p><code>1 &lt;= target.length &lt;= 1000</code></p></li>
<li><p><code>words[i]</code> and <code>target</code> contain only lowercase English letters.</p></li>
</ul>
<h2 id="solution">Solution</h2>
<pre><code class="hljs lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MOD = (<span class="hljs-keyword">int</span>) <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numWays</span><span class="hljs-params">(String[] words, String target)</span> </span>{
        <span class="hljs-keyword">int</span>[][] counts = precompute(words);
        Integer[][] memo = <span class="hljs-keyword">new</span> Integer[target.length()][words[<span class="hljs-number">0</span>].length()];
        <span class="hljs-keyword">return</span> solve(memo, counts, words, target, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[][] precompute(String[] words) {
        <span class="hljs-keyword">int</span>[][] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[words[<span class="hljs-number">0</span>].length()][<span class="hljs-number">26</span>];
        <span class="hljs-keyword">for</span> (String word : words) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>; idx &lt; word.length(); idx++) {
                counts[idx][word.charAt(idx) - <span class="hljs-string">'a'</span>]++;
            }
        }
        <span class="hljs-keyword">return</span> counts;
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">solve</span><span class="hljs-params">(
            Integer[][] memo, <span class="hljs-keyword">int</span>[][] counts, String[] words, String target, <span class="hljs-keyword">int</span> idx, <span class="hljs-keyword">int</span> len)</span> </span>{
        <span class="hljs-keyword">if</span> (idx &gt;= target.length()) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">if</span> (len &gt;= words[<span class="hljs-number">0</span>].length() || words[<span class="hljs-number">0</span>].length() - len &lt; target.length() - idx) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">if</span> (memo[idx][len] != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">return</span> memo[idx][len];
        }
        <span class="hljs-keyword">int</span> answer = <span class="hljs-number">0</span>;
        answer += solve(memo, counts, words, target, idx, len + <span class="hljs-number">1</span>);
        answer %= MOD;
        answer +=
                (<span class="hljs-keyword">int</span>)
                        ((<span class="hljs-keyword">long</span>) solve(memo, counts, words, target, idx + <span class="hljs-number">1</span>, len + <span class="hljs-number">1</span>)
                                * counts[len][target.charAt(idx) - <span class="hljs-string">'a'</span>]
                                % MOD);
        answer %= MOD;
        memo[idx][len] = answer;
        <span class="hljs-keyword">return</span> memo[idx][len];
    }
}
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/curest0x1021/Leetcode-Solution" target="_blank"><img src="https://curest0x1021.github.io/Leetcode-Solution/static/img/github.png" alt="github"/></a></footer></body></html>