<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Number of Orders in the Backlog - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://curest0x1021.github.io/Leetcode-Solution/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://curest0x1021.github.io/Leetcode-Solution/static/css/app.css"/></head><body><header><h1>1801. Number of Orders in the Backlog</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://curest0x1021.github.io/Leetcode-Solution/difficulty/medium" class="tag">Medium</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/array">Array</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/heap-priority-queue">Heap (Priority Queue)</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/simulation">Simulation</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>You are given a 2D integer array <code>orders</code>, where each <code>orders[i] = [pricei, amounti, orderTypei]</code> denotes that <code>amounti</code> orders have been placed of type <code>orderTypei</code> at the price <code>pricei</code>. The <code>orderTypei</code> is:</p>
<ul>
<li><p><code>0</code> if it is a batch of <code>buy</code> orders, or</p></li>
<li><p><code>1</code> if it is a batch of <code>sell</code> orders.</p></li>
</ul>
<p>Note that <code>orders[i]</code> represents a batch of <code>amounti</code> independent orders with the same price and order type. All orders represented by <code>orders[i]</code> will be placed before all orders represented by <code>orders[i+1]</code> for all valid <code>i</code>.</p>
<p>There is a <strong>backlog</strong> that consists of orders that have not been executed. The backlog is initially empty. When an order is placed, the following happens:</p>
<ul>
<li><p>If the order is a <code>buy</code> order, you look at the <code>sell</code> order with the <strong>smallest</strong> price in the backlog. If that <code>sell</code> order's price is <strong>smaller than or equal to</strong> the current <code>buy</code> order's price, they will match and be executed, and that <code>sell</code> order will be removed from the backlog. Else, the <code>buy</code> order is added to the backlog.</p></li>
<li><p>Vice versa, if the order is a <code>sell</code> order, you look at the <code>buy</code> order with the <strong>largest</strong> price in the backlog. If that <code>buy</code> order's price is <strong>larger than or equal to</strong> the current <code>sell</code> order's price, they will match and be executed, and that <code>buy</code> order will be removed from the backlog. Else, the <code>sell</code> order is added to the backlog.</p></li>
</ul>
<p>Return **the total *<em>amount</em>* of orders in the backlog after placing all the orders from the input**. Since this number can be large, return it *<em>modulo</em>* <code>109 + 7</code>.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/03/11/ex1.png" alt="" /></p>
<pre><code class="hljs"><span class="hljs-type">Input</span>: orders = [[<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">30</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>]]
<span class="hljs-type">Output</span>: <span class="hljs-number">6</span>
<span class="hljs-type">Explanation</span>: <span class="hljs-type">Here</span> is what happens <span class="hljs-keyword">with</span> the orders:
- <span class="hljs-number">5</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">buy</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 10 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">There</span> <span class="hljs-title">are</span> <span class="hljs-title">no</span> <span class="hljs-title">sell</span> <span class="hljs-title">orders</span>, <span class="hljs-title">so</span> <span class="hljs-title">the</span> 5 <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">2</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">sell</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 15 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">There</span> <span class="hljs-title">are</span> <span class="hljs-title">no</span> <span class="hljs-title">buy</span> <span class="hljs-title">orders</span> <span class="hljs-keyword">with</span> <span class="hljs-title">prices</span> <span class="hljs-title">larger</span> <span class="hljs-title">than</span> <span class="hljs-title">or</span> <span class="hljs-title">equal</span> <span class="hljs-title">to</span> 15, <span class="hljs-title">so</span> <span class="hljs-title">the</span> 2 <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">1</span> order of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">sell</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 25 <span class="hljs-title">is</span> <span class="hljs-title">placed</span>. <span class="hljs-title">There</span> <span class="hljs-title">are</span> <span class="hljs-title">no</span> <span class="hljs-title">buy</span> <span class="hljs-title">orders</span> <span class="hljs-keyword">with</span> <span class="hljs-title">prices</span> <span class="hljs-title">larger</span> <span class="hljs-title">than</span> <span class="hljs-title">or</span> <span class="hljs-title">equal</span> <span class="hljs-title">to</span> 25 <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>, <span class="hljs-title">so</span> <span class="hljs-title">this</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">4</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">buy</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 30 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">The</span> <span class="hljs-title">first</span> 2 <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">matched</span> <span class="hljs-keyword">with</span> <span class="hljs-title">the</span> 2 <span class="hljs-title">sell</span> <span class="hljs-title">orders</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">least</span> <span class="hljs-title">price</span>, <span class="hljs-title">which</span> <span class="hljs-title">is</span> 15 <span class="hljs-title">and</span> <span class="hljs-title">these</span> 2 <span class="hljs-title">sell</span> <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">removed</span> <span class="hljs-title">from</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>. <span class="hljs-title">The</span> 3<span class="hljs-title">rd</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> <span class="hljs-title">matched</span> <span class="hljs-keyword">with</span> <span class="hljs-title">the</span> <span class="hljs-title">sell</span> <span class="hljs-title">order</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">least</span> <span class="hljs-title">price</span>, <span class="hljs-title">which</span> <span class="hljs-title">is</span> 25 <span class="hljs-title">and</span> <span class="hljs-title">this</span> <span class="hljs-title">sell</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> <span class="hljs-title">removed</span> <span class="hljs-title">from</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>. <span class="hljs-title">Then</span>, <span class="hljs-title">there</span> <span class="hljs-title">are</span> <span class="hljs-title">no</span> <span class="hljs-title">more</span> <span class="hljs-title">sell</span> <span class="hljs-title">orders</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>, <span class="hljs-title">so</span> <span class="hljs-title">the</span> 4<span class="hljs-title">th</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
<span class="hljs-type">Finally</span>, the backlog has <span class="hljs-number">5</span> buy orders <span class="hljs-keyword">with</span> price <span class="hljs-number">10</span>, and <span class="hljs-number">1</span> buy order <span class="hljs-keyword">with</span> price <span class="hljs-number">30.</span> <span class="hljs-type">So</span> the total number of orders in the backlog is <span class="hljs-number">6.</span>
</code></pre>
<p><strong>Example 2:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/03/11/ex2.png" alt="" /></p>
<pre><code class="hljs"><span class="hljs-type">Input</span>: orders = [[<span class="hljs-number">7</span>,<span class="hljs-number">1000000000</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">999999995</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]]
<span class="hljs-type">Output</span>: <span class="hljs-number">999999984</span>
<span class="hljs-type">Explanation</span>: <span class="hljs-type">Here</span> is what happens <span class="hljs-keyword">with</span> the orders:
- <span class="hljs-number">109</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">sell</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 7 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">There</span> <span class="hljs-title">are</span> <span class="hljs-title">no</span> <span class="hljs-title">buy</span> <span class="hljs-title">orders</span>, <span class="hljs-title">so</span> <span class="hljs-title">the</span> 109 <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">3</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">buy</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 15 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">They</span> <span class="hljs-title">are</span> <span class="hljs-title">matched</span> <span class="hljs-keyword">with</span> <span class="hljs-title">the</span> 3 <span class="hljs-title">sell</span> <span class="hljs-title">orders</span> <span class="hljs-keyword">with</span> <span class="hljs-title">the</span> <span class="hljs-title">least</span> <span class="hljs-title">price</span> <span class="hljs-title">which</span> <span class="hljs-title">is</span> 7, <span class="hljs-title">and</span> <span class="hljs-title">those</span> 3 <span class="hljs-title">sell</span> <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">removed</span> <span class="hljs-title">from</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">999999995</span> orders of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">buy</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 5 <span class="hljs-title">are</span> <span class="hljs-title">placed</span>. <span class="hljs-title">The</span> <span class="hljs-title">least</span> <span class="hljs-title">price</span> <span class="hljs-title">of</span> <span class="hljs-title">a</span> <span class="hljs-title">sell</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> 7, <span class="hljs-title">so</span> <span class="hljs-title">the</span> 999999995 <span class="hljs-title">orders</span> <span class="hljs-title">are</span> <span class="hljs-title">added</span> <span class="hljs-title">to</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
- <span class="hljs-number">1</span> order of <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">sell</span> <span class="hljs-keyword">with</span> <span class="hljs-title">price</span> 5 <span class="hljs-title">is</span> <span class="hljs-title">placed</span>. <span class="hljs-title">It</span> <span class="hljs-title">is</span> <span class="hljs-title">matched</span> <span class="hljs-keyword">with</span> <span class="hljs-title">the</span> <span class="hljs-title">buy</span> <span class="hljs-title">order</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">highest</span> <span class="hljs-title">price</span>, <span class="hljs-title">which</span> <span class="hljs-title">is</span> 5, <span class="hljs-title">and</span> <span class="hljs-title">that</span> <span class="hljs-title">buy</span> <span class="hljs-title">order</span> <span class="hljs-title">is</span> <span class="hljs-title">removed</span> <span class="hljs-title">from</span> <span class="hljs-title">the</span> <span class="hljs-title">backlog</span>.</span>
<span class="hljs-type">Finally</span>, the backlog has (<span class="hljs-number">1000000000</span><span class="hljs-number">-3</span>) sell orders <span class="hljs-keyword">with</span> price <span class="hljs-number">7</span>, and (<span class="hljs-number">999999995</span><span class="hljs-number">-1</span>) buy orders <span class="hljs-keyword">with</span> price <span class="hljs-number">5.</span> <span class="hljs-type">So</span> the total number of orders = <span class="hljs-number">1999999991</span>, which is equal to <span class="hljs-number">999999984</span> % (<span class="hljs-number">109</span> + <span class="hljs-number">7</span>).
</code></pre>
<p>&nbsp;
<strong>Constraints:</strong></p>
<ul>
<li><p><code>1 &lt;= orders.length &lt;= 105</code></p></li>
<li><p><code>orders[i].length == 3</code></p></li>
<li><p><code>1 &lt;= pricei, amounti &lt;= 109</code></p></li>
<li><p><code>orderTypei</code> is either <code>0</code> or <code>1</code>.</p></li>
</ul>
<h2 id="solution-java">Solution (Java)</h2>
<pre><code class="hljs lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span> </span>{
        <span class="hljs-keyword">int</span> price;
        <span class="hljs-keyword">int</span> qty;

        Order(<span class="hljs-keyword">int</span> price, <span class="hljs-keyword">int</span> qty) {
            <span class="hljs-keyword">this</span>.price = price;
            <span class="hljs-keyword">this</span>.qty = qty;
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getNumberOfBacklogOrders</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] orders)</span> </span>{
        PriorityQueue&lt;Order&gt; sell = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;(Comparator.comparingInt(a -&gt; a.price));
        PriorityQueue&lt;Order&gt; buy = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((a, b) -&gt; b.price - a.price);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] order : orders) {
            <span class="hljs-keyword">int</span> price = order[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">int</span> amount = order[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">int</span> type = order[<span class="hljs-number">2</span>];
            <span class="hljs-keyword">if</span> (type == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">while</span> (!sell.isEmpty() &amp;&amp; sell.peek().price &lt;= price &amp;&amp; amount &gt; <span class="hljs-number">0</span>) {
                    Order ord = sell.peek();
                    <span class="hljs-keyword">int</span> toRemove = Math.min(amount, ord.qty);
                    ord.qty -= toRemove;
                    amount -= toRemove;
                    <span class="hljs-keyword">if</span> (ord.qty == <span class="hljs-number">0</span>) {
                        sell.poll();
                    }
                }
                <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
                    buy.add(<span class="hljs-keyword">new</span> Order(price, amount));
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">while</span> (!buy.isEmpty() &amp;&amp; buy.peek().price &gt;= price &amp;&amp; amount &gt; <span class="hljs-number">0</span>) {
                    Order ord = buy.peek();
                    <span class="hljs-keyword">int</span> toRemove = Math.min(amount, ord.qty);
                    ord.qty -= toRemove;
                    amount -= toRemove;
                    <span class="hljs-keyword">if</span> (ord.qty == <span class="hljs-number">0</span>) {
                        buy.poll();
                    }
                }
                <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
                    sell.add(<span class="hljs-keyword">new</span> Order(price, amount));
                }
            }
        }
        <span class="hljs-keyword">long</span> sellCount = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (Order ord : sell) {
            sellCount += ord.qty;
        }
        <span class="hljs-keyword">long</span> buyCount = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (Order ord : buy) {
            buyCount += ord.qty;
        }
        <span class="hljs-keyword">long</span> total = sellCount + buyCount;
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>) (total % <span class="hljs-number">1000000007L</span>);
    }
}
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/curest0x1021/Leetcode-Solution" target="_blank"><img src="https://curest0x1021.github.io/Leetcode-Solution/static/img/github.png" alt="github"/></a></footer></body></html>