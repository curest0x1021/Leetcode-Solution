<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Contain Virus - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://baffinlee.com/leetcode-javascript/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://baffinlee.com/leetcode-javascript/static/css/app.css"/></head><body><header><h1>749. Contain Virus</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://baffinlee.com/leetcode-javascript/difficulty/hard" class="tag">Hard</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://baffinlee.com/leetcode-javascript/tag/array">Array</a></li><li><a href="https://baffinlee.com/leetcode-javascript/tag/depth-first-search">Depth-First Search</a></li><li><a href="https://baffinlee.com/leetcode-javascript/tag/breadth-first-search">Breadth-First Search</a></li><li><a href="https://baffinlee.com/leetcode-javascript/tag/matrix">Matrix</a></li><li><a href="https://baffinlee.com/leetcode-javascript/tag/simulation">Simulation</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>A virus is spreading rapidly, and your task is to quarantine the infected area by installing walls.</p>
<p>The world is modeled as an <code>m x n</code> binary grid <code>isInfected</code>, where <code>isInfected[i][j] == 0</code> represents uninfected cells, and <code>isInfected[i][j] == 1</code> represents cells contaminated with the virus. A wall (and only one wall) can be installed between any two <strong>4-directionally</strong> adjacent cells, on the shared boundary.</p>
<p>Every night, the virus spreads to all neighboring cells in all four directions unless blocked by a wall. Resources are limited. Each day, you can install walls around only one region (i.e., the affected area (continuous block of infected cells) that threatens the most uninfected cells the following night). There <strong>will never be a tie</strong>.</p>
<p>Return <strong>the number of walls used to quarantine all the infected regions</strong>. If the world will become fully infected, return the number of walls used.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/06/01/virus11-grid.jpg" alt="" /></p>
<pre><code class="hljs">Input: isInfected = [[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]
Output: <span class="hljs-number">10</span>
Explanation: There are <span class="hljs-number">2</span> contaminated regions.
On the first day, add <span class="hljs-number">5</span> walls to quarantine the viral region on the left. The board after the virus spreads <span class="hljs-keyword">is</span>:

On the second day, add <span class="hljs-number">5</span> walls to quarantine the viral region on the right. The virus <span class="hljs-keyword">is</span> fully contained.

</code></pre>
<p><strong>Example 2:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/06/01/virus2-grid.jpg" alt="" /></p>
<pre><code class="hljs">Input: isInfected = [[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]]
Output: <span class="hljs-number">4</span>
Explanation: Even though there <span class="hljs-keyword">is</span> only one cell saved, there are <span class="hljs-number">4</span> walls built.
Notice that walls are only built on the <span class="hljs-keyword">shared</span> boundary of two different cells.
</code></pre>
<p><strong>Example 3:</strong></p>
<pre><code class="hljs">Input: isInfected = [[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]
Output: <span class="hljs-number">13</span>
Explanation: The region on the left only builds two new walls.
</code></pre>
<p>&nbsp;
<strong>Constraints:</strong></p>
<ul>
<li><p><code>m ==&amp;nbsp;isInfected.length</code></p></li>
<li><p><code>n ==&amp;nbsp;isInfected[i].length</code></p></li>
<li><p><code>1 &lt;= m, n &lt;= 50</code></p></li>
<li><p><code>isInfected[i][j]</code> is either <code>0</code> or <code>1</code>.</p></li>
<li><p>There is always a contiguous viral region throughout the described process that will <strong>infect strictly more uncontaminated squares</strong> in the next round.</p></li>
</ul>
<h2 id="solution-java">Solution (Java)</h2>
<pre><code class="hljs lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> m;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> n;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[][] dirs = {{-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}, {<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">1</span>}, {<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>}};

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">containVirus</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] grid)</span> </span>{
        m = grid.length;
        n = grid[<span class="hljs-number">0</span>].length;
        <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) {
            <span class="hljs-keyword">int</span> id = <span class="hljs-number">0</span>;
            Set&lt;Integer&gt; visited = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();
            Map&lt;Integer, Set&lt;Integer&gt;&gt; islands = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
            Map&lt;Integer, Set&lt;Integer&gt;&gt; scores = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
            Map&lt;Integer, Integer&gt; walls = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++) {
                    <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-number">1</span> &amp;&amp; !visited.contains(i * n + j)) {
                        dfs(i, j, visited, grid, islands, scores, walls, id++);
                    }
                }
            }
            <span class="hljs-keyword">if</span> (islands.isEmpty()) {
                <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">int</span> maxVirus = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; id; i++) {
                <span class="hljs-keyword">if</span> (scores.getOrDefault(maxVirus, <span class="hljs-keyword">new</span> HashSet&lt;&gt;()).size()
                        &lt; scores.getOrDefault(i, <span class="hljs-keyword">new</span> HashSet&lt;&gt;()).size()) {
                    maxVirus = i;
                }
            }
            res += walls.getOrDefault(maxVirus, <span class="hljs-number">0</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; islands.size(); i++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> island : islands.get(i)) {
                    <span class="hljs-keyword">int</span> x = island / n;
                    <span class="hljs-keyword">int</span> y = island % n;
                    <span class="hljs-keyword">if</span> (i == maxVirus) {
                        grid[x][y] = -<span class="hljs-number">1</span>;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) {
                            <span class="hljs-keyword">int</span> nx = x + dir[<span class="hljs-number">0</span>];
                            <span class="hljs-keyword">int</span> ny = y + dir[<span class="hljs-number">1</span>];
                            <span class="hljs-keyword">if</span> (nx &gt;= <span class="hljs-number">0</span> &amp;&amp; nx &lt; m &amp;&amp; ny &gt;= <span class="hljs-number">0</span> &amp;&amp; ny &lt; n &amp;&amp; grid[nx][ny] == <span class="hljs-number">0</span>) {
                                grid[nx][ny] = <span class="hljs-number">1</span>;
                            }
                        }
                    }
                }
            }
        }
        <span class="hljs-keyword">return</span> res;
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(
            <span class="hljs-keyword">int</span> i,
            <span class="hljs-keyword">int</span> j,
            Set&lt;Integer&gt; visited,
            <span class="hljs-keyword">int</span>[][] grid,
            Map&lt;Integer, Set&lt;Integer&gt;&gt; islands,
            Map&lt;Integer, Set&lt;Integer&gt;&gt; scores,
            Map&lt;Integer, Integer&gt; walls,
            <span class="hljs-keyword">int</span> id)</span> </span>{
        <span class="hljs-keyword">if</span> (!visited.add(i * n + j)) {
            <span class="hljs-keyword">return</span>;
        }
        islands.computeIfAbsent(id, value -&gt; <span class="hljs-keyword">new</span> HashSet&lt;&gt;()).add(i * n + j);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) {
            <span class="hljs-keyword">int</span> x = i + dir[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">int</span> y = j + dir[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">0</span> || x &gt;= m || y &lt; <span class="hljs-number">0</span> || y &gt;= n) {
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-keyword">if</span> (grid[x][y] == <span class="hljs-number">1</span>) {
                dfs(x, y, visited, grid, islands, scores, walls, id);
            }
            <span class="hljs-keyword">if</span> (grid[x][y] == <span class="hljs-number">0</span>) {
                scores.computeIfAbsent(id, value -&gt; <span class="hljs-keyword">new</span> HashSet&lt;&gt;()).add(x * n + y);
                walls.put(id, walls.getOrDefault(id, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
            }
        }
    }
}
</code></pre>
<h2 id="solution-c">Solution (C++)</h2>
<pre><code class="hljs lang-cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">containVirus</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;&amp; grid)</span> 
    </span>{
        <span class="hljs-keyword">int</span> rows = grid.size() , cols = grid[<span class="hljs-number">0</span>].size() ;
        <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; dir = { <span class="hljs-number">-1</span> , <span class="hljs-number">0</span> , <span class="hljs-number">1</span> , <span class="hljs-number">0</span> , <span class="hljs-number">-1</span>} ;
        <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span> ; <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span> ;

        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)
        {
            root = <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;(rows * cols , <span class="hljs-number">-1</span>) ;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ; i &lt; rows * cols ; i++) root[i] = i ;
            <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-keyword">int</span> , <span class="hljs-built_in">unordered_set</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt; virus , infecteds ;
            <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-keyword">int</span> , <span class="hljs-keyword">int</span> &gt; walls ;
            <span class="hljs-keyword">int</span> non_infs = <span class="hljs-number">0</span> , mx_infs = <span class="hljs-number">0</span> , key = <span class="hljs-number">-1</span> ; 
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ; i &lt; rows ; ++i)
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span> ; j &lt; cols ; ++j)
                {
                    <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">0</span>)
                    {
                        non_infs++ ;
                        <span class="hljs-keyword">continue</span> ;
                    }
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">-1</span>) <span class="hljs-keyword">continue</span> ;

                    <span class="hljs-built_in">set</span>&lt;<span class="hljs-keyword">int</span>&gt; new_infs ;
                    <span class="hljs-keyword">int</span> rt = find(i * cols + j) ;

                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span> ; k &lt; <span class="hljs-number">4</span> ; ++k)
                    {
                        <span class="hljs-keyword">int</span> new_i = i + dir[k] , new_j = j + dir[k + <span class="hljs-number">1</span>] ;
                        <span class="hljs-keyword">if</span>(new_i &lt; <span class="hljs-number">0</span> || new_i &gt;= rows || new_j &lt; <span class="hljs-number">0</span> || new_j &gt;= cols) <span class="hljs-keyword">continue</span> ;
                        <span class="hljs-keyword">if</span>(grid[new_i][new_j] == <span class="hljs-number">0</span>) 
                        {
                            new_infs.insert(new_i * cols + new_j) ;
                            <span class="hljs-keyword">continue</span> ;
                        }
                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(grid[new_i][new_j] == <span class="hljs-number">1</span>) 
                        {
                            <span class="hljs-keyword">int</span> x = find(new_i * cols + new_j) ;
                            rt = merge(rt , x , virus , infecteds , walls) ;
                        }
                    }

                    virus[rt].insert(i * cols + j) ;
                    infecteds[rt].insert(new_infs.begin() , new_infs.end()) ;
                    walls[rt] += new_infs.size() ;

                    <span class="hljs-keyword">if</span>(infecteds[rt].size() &gt; mx_infs) 
                    {
                        mx_infs = infecteds[rt].size() ;
                        key = rt ;
                    }

                }

            <span class="hljs-keyword">if</span>(non_infs == <span class="hljs-number">0</span> || mx_infs == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> res ;

            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> ele : virus[key]) grid[ele / cols][ele % cols] = <span class="hljs-number">-1</span> ;
            res += walls[key] ;
            infecteds.erase(key) ;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> ele : infecteds)
            {
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> e : ele.second) grid[e / cols][e % cols] = <span class="hljs-number">1</span> ;
            }
            cnt++;
        }

        <span class="hljs-keyword">return</span> res ;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span>
    </span>{
        <span class="hljs-keyword">return</span> root[i] == i ? i : find(root[i]) ;
    }

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i , <span class="hljs-keyword">int</span> j , <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-keyword">int</span> , <span class="hljs-built_in">unordered_set</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;&amp; virus , <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-keyword">int</span> , <span class="hljs-built_in">unordered_set</span>&lt;<span class="hljs-keyword">int</span>&gt;&gt;&amp; infecteds , <span class="hljs-built_in">unordered_map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;&amp; walls)</span>
    </span>{
        <span class="hljs-keyword">int</span> x = find(i) , y = find(j) ;
        <span class="hljs-keyword">if</span>(x &lt; y)
        {
            root[y] = x ;
            virus[x].insert(virus[y].begin() , virus[y].end()) ;
            virus.erase(y) ;
            infecteds[x].insert(infecteds[y].begin() , infecteds[y].end()) ;
            infecteds.erase(y) ;
            walls[x] += walls[y] ;
            walls.erase(y) ;
            <span class="hljs-keyword">return</span> x ;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(x &gt; y)
        {
            root[x] = y ;
            virus[y].insert(virus[x].begin() , virus[x].end()) ;
            virus.erase(x) ;
            infecteds[y].insert(infecteds[x].begin() , infecteds[x].end()) ;
            infecteds.erase(x) ;
            walls[y] += walls[x] ;
            walls.erase(x) ;
            <span class="hljs-keyword">return</span> y ;
        }
        <span class="hljs-keyword">return</span> x ;
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; root ;
};
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/BaffinLee/leetcode-javascript" target="_blank"><img src="https://baffinlee.com/leetcode-javascript/static/img/github.png" alt="github"/></a></footer></body></html>