<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Human Traffic of Stadium - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://baffinlee.com/leetcode-javascript/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://baffinlee.com/leetcode-javascript/static/css/app.css"/></head><body><header><h1>601. Human Traffic of Stadium</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://baffinlee.com/leetcode-javascript/difficulty/hard" class="tag">Hard</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://baffinlee.com/leetcode-javascript/tag/database">Database</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>Table: <code>Stadium</code></p>
<pre><code class="hljs">+<span class="hljs-comment">---------------+---------+</span>
| <span class="hljs-keyword">Column</span> <span class="hljs-type">Name</span>   | <span class="hljs-keyword">Type</span>    |
+<span class="hljs-comment">---------------+---------+</span>
| id            | <span class="hljs-type">int</span>     |
| visit_date    | <span class="hljs-type">date</span>    |
| people        | <span class="hljs-type">int</span>     |
+<span class="hljs-comment">---------------+---------+</span>
visit_date <span class="hljs-keyword">is</span> the <span class="hljs-keyword">primary key</span> <span class="hljs-keyword">for</span> this <span class="hljs-keyword">table</span>.
<span class="hljs-keyword">Each</span> <span class="hljs-keyword">row</span> <span class="hljs-keyword">of</span> this <span class="hljs-keyword">table</span> contains the visit <span class="hljs-type">date</span> <span class="hljs-keyword">and</span> visit id <span class="hljs-keyword">to</span> the stadium <span class="hljs-keyword">with</span> the number <span class="hljs-keyword">of</span> people during the visit.
<span class="hljs-keyword">No</span> two <span class="hljs-keyword">rows</span> will have the same visit_date, <span class="hljs-keyword">and</span> <span class="hljs-keyword">as</span> the id increases, the dates increase <span class="hljs-keyword">as</span> well.
</code></pre>
<p>&nbsp;</p>
<p>Write an SQL query to display the records with three or more rows with <strong>consecutive</strong> <code>id</code>'s, and the number of people is greater than or equal to 100 for each.</p>
<p>Return the result table ordered by <code>visit_date</code> in <strong>ascending order</strong>.</p>
<p>The query result format is in the following example.</p>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs">Input: 
Stadium table:
+------+------------+-----------+
| id   | visit_date | people    |
+------+------------+-----------+
| <span class="hljs-number">1</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-01</span> | <span class="hljs-number">10</span>        |
| <span class="hljs-number">2</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-02</span> | <span class="hljs-number">109</span>       |
| <span class="hljs-number">3</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-03</span> | <span class="hljs-number">150</span>       |
| <span class="hljs-number">4</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-04</span> | <span class="hljs-number">99</span>        |
| <span class="hljs-number">5</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-05</span> | <span class="hljs-number">145</span>       |
| <span class="hljs-number">6</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-06</span> | <span class="hljs-number">1455</span>      |
| <span class="hljs-number">7</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-07</span> | <span class="hljs-number">199</span>       |
| <span class="hljs-number">8</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-09</span> | <span class="hljs-number">188</span>       |
+------+------------+-----------+
Output: 
+------+------------+-----------+
| id   | visit_date | people    |
+------+------------+-----------+
| <span class="hljs-number">5</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-05</span> | <span class="hljs-number">145</span>       |
| <span class="hljs-number">6</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-06</span> | <span class="hljs-number">1455</span>      |
| <span class="hljs-number">7</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-07</span> | <span class="hljs-number">199</span>       |
| <span class="hljs-number">8</span>    | <span class="hljs-number">2017</span><span class="hljs-number">-01</span><span class="hljs-number">-09</span> | <span class="hljs-number">188</span>       |
+------+------------+-----------+
Explanation: 
The four rows with ids <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-keyword">and</span> <span class="hljs-number">8</span> have consecutive ids <span class="hljs-keyword">and</span> each of them has &gt;= <span class="hljs-number">100</span> people attended. Note that row <span class="hljs-number">8</span> was included even though the visit_date was <span class="hljs-keyword">not</span> the next day after row <span class="hljs-number">7.</span>
The rows with ids <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-number">3</span> are <span class="hljs-keyword">not</span> included because we need at least three consecutive ids.
</code></pre>
<h2 id="solution">Solution</h2>
<pre><code class="hljs lang-sql"><span class="hljs-comment"># Write your MySQL query statement below</span>
<span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> day1.* 
<span class="hljs-keyword">from</span> 
stadium day1, stadium day2, stadium day3
<span class="hljs-keyword">where</span> 
day1.people &gt;= <span class="hljs-number">100</span> <span class="hljs-keyword">and</span> day2.people &gt;= <span class="hljs-number">100</span> 
<span class="hljs-keyword">and</span> day3.people &gt;= <span class="hljs-number">100</span> <span class="hljs-keyword">and</span>
((day1.id + <span class="hljs-number">1</span> =  day2.id <span class="hljs-keyword">and</span> day1.id + <span class="hljs-number">2</span> = day3.id) <span class="hljs-keyword">or</span> 
(day1.id - <span class="hljs-number">1</span> = day2.id <span class="hljs-keyword">and</span> day1.id + <span class="hljs-number">1</span> = day3.id) <span class="hljs-keyword">or</span> 
(day1.id - <span class="hljs-number">2</span> = day2.id <span class="hljs-keyword">and</span> day1.id - <span class="hljs-number">1</span> = day3.id)) 
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> day1.id; 
</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/BaffinLee/leetcode-javascript" target="_blank"><img src="https://baffinlee.com/leetcode-javascript/static/img/github.png" alt="github"/></a></footer></body></html>