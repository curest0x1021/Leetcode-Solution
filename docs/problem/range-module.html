<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Range Module - LeetCode javascript solutions</title><link rel="shortcut icon" href="https://curest0x1021.github.io/Leetcode-Solution/static/img/favicon.png" type="image/png"/><link rel="stylesheet" href="https://curest0x1021.github.io/Leetcode-Solution/static/css/app.css"/></head><body><header><h1>715. Range Module</h1><div class="row"><div class="name">Difficulty:</div><div class="value"><a href="https://curest0x1021.github.io/Leetcode-Solution/difficulty/hard" class="tag">Hard</a></div></div><div class="row"><div class="name">Related Topics:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/design">Design</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/segment-tree">Segment Tree</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/tag/ordered-set">Ordered Set</a></li></ul></div></div><div class="row"><div class="name">Similar Questions:</div><div class="value"><ul class="clearfix"><li><a href="https://curest0x1021.github.io/Leetcode-Solution/problem/merge-intervals.html">Merge Intervals</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/problem/insert-interval.html">Insert Interval</a></li><li><a href="https://curest0x1021.github.io/Leetcode-Solution/problem/data-stream-as-disjoint-intervals.html">Data Stream as Disjoint Intervals</a></li></ul></div></div></header><main><article class="markdown-body"><h2 id="problem">Problem</h2>
<p>A Range Module is a module that tracks ranges of numbers. Design a data structure to track the ranges represented as <strong>half-open intervals</strong> and query about them.</p>
<p>A <strong>half-open interval</strong> <code>[left, right)</code> denotes all the real numbers <code>x</code> where <code>left &lt;= x &lt; right</code>.</p>
<p>Implement the <code>RangeModule</code> class:</p>
<ul>
<li><p><code>RangeModule()</code> Initializes the object of the data structure.</p></li>
<li><p><code>void addRange(int left, int right)</code> Adds the <strong>half-open interval</strong> <code>[left, right)</code>, tracking every real number in that interval. Adding an interval that partially overlaps with currently tracked numbers should add any numbers in the interval <code>[left, right)</code> that are not already tracked.</p></li>
<li><p><code>boolean queryRange(int left, int right)</code> Returns <code>true</code> if every real number in the interval <code>[left, right)</code> is currently being tracked, and <code>false</code> otherwise.</p></li>
<li><p><code>void removeRange(int left, int right)</code> Stops tracking every real number currently being tracked in the <strong>half-open interval</strong> <code>[left, right)</code>.</p></li>
</ul>
<p>&nbsp;
<strong>Example 1:</strong></p>
<pre><code class="hljs"><span class="hljs-string">Input</span>
<span class="hljs-string">["RangeModule",</span> <span class="hljs-string">"addRange"</span><span class="hljs-string">,</span> <span class="hljs-string">"removeRange"</span><span class="hljs-string">,</span> <span class="hljs-string">"queryRange"</span><span class="hljs-string">,</span> <span class="hljs-string">"queryRange"</span><span class="hljs-string">,</span> <span class="hljs-string">"queryRange"</span><span class="hljs-string">]</span>
<span class="hljs-string">[[],</span> <span class="hljs-string">[10,</span> <span class="hljs-number">20</span><span class="hljs-string">],</span> <span class="hljs-string">[14,</span> <span class="hljs-number">16</span><span class="hljs-string">],</span> <span class="hljs-string">[10,</span> <span class="hljs-number">14</span><span class="hljs-string">],</span> <span class="hljs-string">[13,</span> <span class="hljs-number">15</span><span class="hljs-string">],</span> <span class="hljs-string">[16,</span> <span class="hljs-number">17</span><span class="hljs-string">]]</span>
<span class="hljs-string">Output</span>
<span class="hljs-string">[null,</span> <span class="hljs-literal">null</span><span class="hljs-string">,</span> <span class="hljs-literal">null</span><span class="hljs-string">,</span> <span class="hljs-literal">true</span><span class="hljs-string">,</span> <span class="hljs-literal">false</span><span class="hljs-string">,</span> <span class="hljs-literal">true</span><span class="hljs-string">]</span>

<span class="hljs-string">Explanation</span>
<span class="hljs-string">RangeModule</span> <span class="hljs-string">rangeModule</span> <span class="hljs-string">=</span> <span class="hljs-string">new</span> <span class="hljs-string">RangeModule();</span>
<span class="hljs-string">rangeModule.addRange(10,</span> <span class="hljs-number">20</span><span class="hljs-string">);</span>
<span class="hljs-string">rangeModule.removeRange(14,</span> <span class="hljs-number">16</span><span class="hljs-string">);</span>
<span class="hljs-string">rangeModule.queryRange(10,</span> <span class="hljs-number">14</span><span class="hljs-string">);</span> <span class="hljs-string">//</span> <span class="hljs-string">return</span> <span class="hljs-literal">True</span><span class="hljs-string">,(Every</span> <span class="hljs-string">number</span> <span class="hljs-string">in</span> <span class="hljs-string">[10,</span> <span class="hljs-number">14</span><span class="hljs-string">)</span> <span class="hljs-string">is</span> <span class="hljs-string">being</span> <span class="hljs-string">tracked)</span>
<span class="hljs-string">rangeModule.queryRange(13,</span> <span class="hljs-number">15</span><span class="hljs-string">);</span> <span class="hljs-string">//</span> <span class="hljs-string">return</span> <span class="hljs-literal">False</span><span class="hljs-string">,(Numbers</span> <span class="hljs-string">like</span> <span class="hljs-number">14</span><span class="hljs-string">,</span> <span class="hljs-number">14.03</span><span class="hljs-string">,</span> <span class="hljs-number">14.17</span> <span class="hljs-string">in</span> <span class="hljs-string">[13,</span> <span class="hljs-number">15</span><span class="hljs-string">)</span> <span class="hljs-string">are</span> <span class="hljs-string">not</span> <span class="hljs-string">being</span> <span class="hljs-string">tracked)</span>
<span class="hljs-string">rangeModule.queryRange(16,</span> <span class="hljs-number">17</span><span class="hljs-string">);</span> <span class="hljs-string">//</span> <span class="hljs-string">return</span> <span class="hljs-literal">True</span><span class="hljs-string">,</span> <span class="hljs-string">(The</span> <span class="hljs-string">number</span> <span class="hljs-number">16</span> <span class="hljs-string">in</span> <span class="hljs-string">[16,</span> <span class="hljs-number">17</span><span class="hljs-string">)</span> <span class="hljs-string">is</span> <span class="hljs-string">still</span> <span class="hljs-string">being</span> <span class="hljs-string">tracked,</span> <span class="hljs-string">despite</span> <span class="hljs-string">the</span> <span class="hljs-string">remove</span> <span class="hljs-string">operation)</span>
</code></pre>
<p>&nbsp;
<strong>Constraints:</strong></p>
<ul>
<li><p><code>1 &lt;= left &lt; right &lt;= 109</code></p></li>
<li><p>At most <code>104</code> calls will be made to <code>addRange</code>, <code>queryRange</code>, and <code>removeRange</code>.</p></li>
</ul>
<h2 id="solution-java">Solution (Java)</h2>
<pre><code class="hljs lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RangeModule</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Interval head;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RangeModule</span><span class="hljs-params">()</span> </span>{
        head = <span class="hljs-keyword">new</span> Interval(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        Interval pos = head;
        <span class="hljs-keyword">while</span> (pos.next != <span class="hljs-keyword">null</span> &amp;&amp; pos.next.end &lt; left) {
            pos = pos.next;
        }
        <span class="hljs-keyword">while</span> (pos.next != <span class="hljs-keyword">null</span> &amp;&amp; pos.next.start &lt;= right) {
            left = Math.min(pos.next.start, left);
            right = Math.max(pos.next.end, right);
            removeNext(pos);
        }
        insert(pos, <span class="hljs-keyword">new</span> Interval(left, right));
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">queryRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        Interval pos = head;
        <span class="hljs-keyword">while</span> (pos != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">if</span> (left &gt;= pos.start &amp;&amp; right &lt;= pos.end) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
            pos = pos.next;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        Interval pos = head;
        <span class="hljs-keyword">while</span> (pos.next != <span class="hljs-keyword">null</span> &amp;&amp; pos.next.end &lt;= left) {
            pos = pos.next;
        }
        Interval prev = pos;
        Interval curr = pos.next;
        <span class="hljs-keyword">while</span> (curr != <span class="hljs-keyword">null</span> &amp;&amp; curr.start &lt; right) {
            <span class="hljs-keyword">if</span> (curr.start &lt; left) {
                insert(prev, <span class="hljs-keyword">new</span> Interval(curr.start, left));
                curr.start = left;
                prev = prev.next;
                curr = prev.next;
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-keyword">if</span> (right &gt;= curr.end) {
                removeNext(prev);
                curr = prev.next;
            } <span class="hljs-keyword">else</span> {
                curr.start = right;
                curr = curr.next;
            }
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(Interval curr, Interval next)</span> </span>{
        next.next = curr.next;
        curr.next = next;
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeNext</span><span class="hljs-params">(Interval curr)</span> </span>{
        Interval del = curr.next;
        <span class="hljs-keyword">if</span> (del != <span class="hljs-keyword">null</span>) {
            curr.next = del.next;
            del.next = <span class="hljs-keyword">null</span>;
        }
    }

    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Interval</span> </span>{
        <span class="hljs-keyword">int</span> start;
        <span class="hljs-keyword">int</span> end;
        Interval next;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Interval</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>{
            start = l;
            end = r;
        }
    }
}

<span class="hljs-comment">/**
 * Your RangeModule object will be instantiated and called as such:
 * RangeModule obj = new RangeModule();
 * obj.addRange(left,right);
 * boolean param_2 = obj.queryRange(left,right);
 * obj.removeRange(left,right);
 */</span>
</code></pre>
<h2 id="solution-c">Solution (C++)</h2>
<pre><code class="hljs lang-cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RangeModule</span> {</span>
<span class="hljs-keyword">public</span>:
    RangeModule() {}

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        IT l, r;
        getOverlapRanges(left, right, l, r);
        <span class="hljs-comment">// At least one range overlapping with [left, right)</span>
        <span class="hljs-keyword">if</span> (l != r) {
            <span class="hljs-comment">// Merge intervals into [left, right)</span>
            <span class="hljs-keyword">auto</span> last = r; --last;
            left = min(left, l-&gt;first);            
            right = max(right, last-&gt;second);
            <span class="hljs-comment">// Remove all overlapped ranges</span>
            ranges_.erase(l, r);
        }
        <span class="hljs-comment">// Add a new/merged range</span>
        ranges_[left] = right;
    }

    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">queryRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        IT l, r;
        getOverlapRanges(left, right, l, r);
        <span class="hljs-comment">// No overlapping range</span>
        <span class="hljs-keyword">if</span> (l == r) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> l-&gt;first &lt;= left &amp;&amp; l-&gt;second &gt;= right;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">removeRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>{
        IT l, r;
        getOverlapRanges(left, right, l, r);
        <span class="hljs-comment">// No overlapping range</span>
        <span class="hljs-keyword">if</span> (l == r) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">auto</span> last = r; --last;
        <span class="hljs-keyword">int</span> start = min(left, l-&gt;first);        
        <span class="hljs-keyword">int</span> end = max(right, last-&gt;second);
        <span class="hljs-comment">// Delete overlapping ranges        </span>
        ranges_.erase(l, r);
        <span class="hljs-keyword">if</span> (start &lt; left) ranges_[start] = left;
        <span class="hljs-keyword">if</span> (end &gt; right) ranges_[right] = end;
    }
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">typedef</span> <span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;::iterator IT;
    <span class="hljs-built_in">map</span>&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; ranges_;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">getOverlapRanges</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, IT&amp; l, IT&amp; r)</span> </span>{
        l = ranges_.upper_bound(left);
        r = ranges_.upper_bound(right);
        <span class="hljs-keyword">if</span> (l != ranges_.begin())
            <span class="hljs-keyword">if</span> ((--l)-&gt;second &lt; left) l++;
    }
};

</code></pre>
<p><strong>Explain:</strong></p>
<p>nope.</p>
<p><strong>Complexity:</strong></p>
<ul>
<li>Time complexity : O(n).</li>
<li>Space complexity : O(n).</li>
</ul></article></main><footer><a href="https://github.com/curest0x1021/Leetcode-Solution" target="_blank"><img src="https://curest0x1021.github.io/Leetcode-Solution/static/img/github.png" alt="github"/></a></footer></body></html>